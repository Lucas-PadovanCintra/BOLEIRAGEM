<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h2 fw-bold text-dark">Mercado de Jogadores</h1>
    <%= link_to "Adicionar Novo Jogador", new_player_path, class: "btn btn-primary" %>
  </div>

  <!-- Market Filter -->
  <div class="mb-4">
    <div class="btn-group" role="group">
      <button type="button" class="btn btn-success btn-sm">Todos os Jogadores</button>
      <button type="button" class="btn btn-outline-secondary btn-sm">Dispon√≠veis</button>
      <button type="button" class="btn btn-outline-secondary btn-sm">Contratados</button>
    </div>
  </div>

  <% if @players.any? %>
    <div class="card shadow-sm">
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead class="table-light">
            <tr>
              <th scope="col" class="fw-bold text-muted small text-uppercase">Jogador</th>
              <th scope="col" class="fw-bold text-muted small text-uppercase">Avalia√ß√£o</th>
              <th scope="col" class="fw-bold text-muted small text-uppercase">Pre√ßo</th>
              <th scope="col" class="fw-bold text-muted small text-uppercase">Status</th>
              <th scope="col" class="fw-bold text-muted small text-uppercase">Time Atual</th>
              <th scope="col" class="fw-bold text-muted small text-uppercase">A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
              <% @players.each do |player| %>
                <tr>
                  <td>
                    <div class="fw-medium text-dark"><%= player.name %></div>
                    <small class="text-muted">API ID: <%= player.api_id %></small>
                  </td>
                  <td>
                    <div class="d-flex align-items-center">
                      <span class="fs-5 fw-bold text-primary me-2"><%= player.rating %></span>
                      <div class="d-flex">
                        <% (1..5).each do |i| %>
                          <% if i <= (player.rating / 20.0).ceil %>
                            <i class="fas fa-star text-warning"></i>
                          <% else %>
                            <i class="far fa-star text-muted"></i>
                          <% end %>
                        <% end %>
                      </div>
                    </div>
                  </td>
                  <td>
                    <span class="fs-5 fw-bold text-success">üí∞<%= number_with_delimiter(player.price) %></span>
                  </td>
                  <td>
                    <% if player.is_on_market %>
                      <span class="badge bg-success">Dispon√≠vel</span>
                    <% else %>
                      <span class="badge bg-danger">Contratado</span>
                    <% end %>
                  </td>
                  <td class="text-muted">
                    <% current_contract = player.player_contracts.where(is_expired: false).first %>
                    <% if current_contract %>
                      <%= current_contract.team.name %>
                    <% else %>
                      <span class="text-muted">Agente livre</span>
                    <% end %>
                  </td>
                  <td>
                    <div class="btn-group btn-group-sm">
                      <%= link_to "Ver", player, class: "btn btn-outline-primary btn-sm" %>
                      <%= link_to "Editar", edit_player_path(player), class: "btn btn-outline-warning btn-sm" %>
                      <% if player.is_on_market %>
                        <%= link_to "Contratar", new_player_contract_path(player_id: player.id), class: "btn btn-success btn-sm" %>
                      <% end %>
                    </div>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    <% else %>
      <div class="text-center py-5">
        <div class="mb-4">
          <i class="fas fa-users text-muted" style="font-size: 4rem;"></i>
        </div>
        <h3 class="h4 fw-medium text-dark mb-2">Nenhum jogador dispon√≠vel</h3>
        <p class="text-muted mb-4">Adicione jogadores ao mercado para come√ßar!</p>
        <%= link_to "Adicionar Primeiro Jogador", new_player_path, class: "btn btn-primary btn-lg" %>
      </div>
    <% end %>
</div>